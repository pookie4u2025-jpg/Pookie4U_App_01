{"dependencies":[{"name":"./common","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":45,"index":60}}],"key":"T3X1rGrsueEhPeOGTLhHRm6Tz+4=","exportNames":["*"],"imports":1}},{"name":"./core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":61},"end":{"line":4,"column":70,"index":131}}],"key":"0ONCEUiDM4TuRiJMnypk4k7v4nE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"WorkletEventHandler\", {\n    enumerable: true,\n    get: function () {\n      return WorkletEventHandler;\n    }\n  });\n  var _common = require(_dependencyMap[0], \"./common\");\n  var _core = require(_dependencyMap[1], \"./core\");\n  // In JS implementation (e.g. for web) we don't use Reanimated's\n  // event emitter, therefore we have to handle here\n  // the event that came from React Native and convert it.\n  function jsListener(eventName, handler) {\n    return evt => {\n      handler(Object.assign({}, evt.nativeEvent, {\n        eventName\n      }));\n    };\n  }\n  class WorkletEventHandlerNative {\n    #viewTags;\n    #registrations; // keys are viewTags, values are arrays of registration ID's for each viewTag\n    constructor(worklet, eventNames) {\n      this.worklet = worklet;\n      this.eventNames = eventNames;\n      this.#viewTags = new Set();\n      this.#registrations = new Map();\n    }\n    updateEventHandler(newWorklet, newEvents) {\n      // Update worklet and event names\n      this.worklet = newWorklet;\n      this.eventNames = newEvents;\n\n      // Detach all events\n      this.#registrations.forEach(registrationIDs => {\n        registrationIDs.forEach(id => (0, _core.unregisterEventHandler)(id));\n        // No need to remove registrationIDs from map, since it gets overwritten when attaching\n      });\n\n      // Attach new events with new worklet\n      Array.from(this.#viewTags).forEach(tag => {\n        const newRegistrations = this.eventNames.map(eventName => (0, _core.registerEventHandler)(this.worklet, eventName, tag));\n        this.#registrations.set(tag, newRegistrations);\n      });\n    }\n    registerForEvents(viewTag, fallbackEventName) {\n      this.#viewTags.add(viewTag);\n      const newRegistrations = this.eventNames.map(eventName => (0, _core.registerEventHandler)(this.worklet, eventName, viewTag));\n      this.#registrations.set(viewTag, newRegistrations);\n      if (this.eventNames.length === 0 && fallbackEventName) {\n        const newRegistration = (0, _core.registerEventHandler)(this.worklet, fallbackEventName, viewTag);\n        this.#registrations.set(viewTag, [newRegistration]);\n      }\n    }\n    unregisterFromEvents(viewTag) {\n      this.#viewTags.delete(viewTag);\n      this.#registrations.get(viewTag)?.forEach(id => {\n        (0, _core.unregisterEventHandler)(id);\n      });\n      this.#registrations.delete(viewTag);\n    }\n  }\n  class WorkletEventHandlerWeb {\n    constructor(worklet, eventNames = []) {\n      this.worklet = worklet;\n      this.eventNames = eventNames;\n      this.listeners = {};\n      this.setupWebListeners();\n    }\n    setupWebListeners() {\n      this.listeners = {};\n      this.eventNames.forEach(eventName => {\n        this.listeners[eventName] = jsListener(eventName, this.worklet);\n      });\n    }\n    updateEventHandler(newWorklet, newEvents) {\n      // Update worklet and event names\n      this.worklet = newWorklet;\n      this.eventNames = newEvents;\n      this.setupWebListeners();\n    }\n    registerForEvents(_viewTag, _fallbackEventName) {\n      // noop\n    }\n    unregisterFromEvents(_viewTag) {\n      // noop\n    }\n  }\n  const WorkletEventHandler = _common.SHOULD_BE_USE_WEB ? WorkletEventHandlerWeb : WorkletEventHandlerNative;\n});","lineCount":95,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13,"Object"],[4,8,1,13],[4,9,1,13,"defineProperty"],[4,23,1,13],[4,24,1,13,"exports"],[4,31,1,13],[5,4,1,13,"value"],[5,9,1,13],[6,2,1,13],[7,2,85,0,"Object"],[7,8,85,0],[7,9,85,0,"defineProperty"],[7,23,85,0],[7,24,85,0,"exports"],[7,31,85,0],[8,4,85,0,"enumerable"],[8,14,85,0],[9,4,85,0,"get"],[9,7,85,0],[9,18,85,0,"get"],[9,19,85,0],[10,6,85,0],[10,13,85,0,"WorkletEventHandler"],[10,32,85,0],[11,4,85,0],[12,2,85,0],[13,2,3,0],[13,6,3,0,"_common"],[13,13,3,0],[13,16,3,0,"require"],[13,23,3,0],[13,24,3,0,"_dependencyMap"],[13,38,3,0],[14,2,4,0],[14,6,4,0,"_core"],[14,11,4,0],[14,14,4,0,"require"],[14,21,4,0],[14,22,4,0,"_dependencyMap"],[14,36,4,0],[15,2,5,0],[16,2,6,0],[17,2,7,0],[18,2,8,0],[18,11,8,9,"jsListener"],[18,21,8,19,"jsListener"],[18,22,8,20,"eventName"],[18,31,8,29],[18,33,8,31,"handler"],[18,40,8,38],[18,42,8,40],[19,4,9,2],[19,11,9,9,"evt"],[19,14,9,12],[19,18,9,16],[20,6,10,4,"handler"],[20,13,10,11],[20,14,10,11,"Object"],[20,20,10,11],[20,21,10,11,"assign"],[20,27,10,11],[20,32,11,9,"evt"],[20,35,11,12],[20,36,11,13,"nativeEvent"],[20,47,11,24],[21,8,12,6,"eventName"],[22,6,12,15],[22,8,13,5],[22,9,13,6],[23,4,14,2],[23,5,14,3],[24,2,15,0],[25,2,16,0],[25,8,16,6,"WorkletEventHandlerNative"],[25,33,16,31],[25,34,16,32],[26,4,17,2],[26,5,17,3,"viewTags"],[26,13,17,11],[27,4,18,2],[27,5,18,3,"registrations"],[27,18,18,16],[27,19,18,17],[27,20,18,18],[28,4,19,2,"constructor"],[28,15,19,13,"constructor"],[28,16,19,14,"worklet"],[28,23,19,21],[28,25,19,23,"eventNames"],[28,35,19,33],[28,37,19,35],[29,6,20,4],[29,10,20,8],[29,11,20,9,"worklet"],[29,18,20,16],[29,21,20,19,"worklet"],[29,28,20,26],[30,6,21,4],[30,10,21,8],[30,11,21,9,"eventNames"],[30,21,21,19],[30,24,21,22,"eventNames"],[30,34,21,32],[31,6,22,4],[31,10,22,8],[31,11,22,9],[31,12,22,10,"viewTags"],[31,20,22,18],[31,23,22,21],[31,27,22,25,"Set"],[31,30,22,28],[31,31,22,29],[31,32,22,30],[32,6,23,4],[32,10,23,8],[32,11,23,9],[32,12,23,10,"registrations"],[32,25,23,23],[32,28,23,26],[32,32,23,30,"Map"],[32,35,23,33],[32,36,23,34],[32,37,23,35],[33,4,24,2],[34,4,25,2,"updateEventHandler"],[34,22,25,20,"updateEventHandler"],[34,23,25,21,"newWorklet"],[34,33,25,31],[34,35,25,33,"newEvents"],[34,44,25,42],[34,46,25,44],[35,6,26,4],[36,6,27,4],[36,10,27,8],[36,11,27,9,"worklet"],[36,18,27,16],[36,21,27,19,"newWorklet"],[36,31,27,29],[37,6,28,4],[37,10,28,8],[37,11,28,9,"eventNames"],[37,21,28,19],[37,24,28,22,"newEvents"],[37,33,28,31],[39,6,30,4],[40,6,31,4],[40,10,31,8],[40,11,31,9],[40,12,31,10,"registrations"],[40,25,31,23],[40,26,31,24,"forEach"],[40,33,31,31],[40,34,31,32,"registrationIDs"],[40,49,31,47],[40,53,31,51],[41,8,32,6,"registrationIDs"],[41,23,32,21],[41,24,32,22,"forEach"],[41,31,32,29],[41,32,32,30,"id"],[41,34,32,32],[41,38,32,36],[41,42,32,36,"unregisterEventHandler"],[41,47,32,58],[41,48,32,58,"unregisterEventHandler"],[41,70,32,58],[41,72,32,59,"id"],[41,74,32,61],[41,75,32,62],[41,76,32,63],[42,8,33,6],[43,6,34,4],[43,7,34,5],[43,8,34,6],[45,6,36,4],[46,6,37,4,"Array"],[46,11,37,9],[46,12,37,10,"from"],[46,16,37,14],[46,17,37,15],[46,21,37,19],[46,22,37,20],[46,23,37,21,"viewTags"],[46,31,37,29],[46,32,37,30],[46,33,37,31,"forEach"],[46,40,37,38],[46,41,37,39,"tag"],[46,44,37,42],[46,48,37,46],[47,8,38,6],[47,14,38,12,"newRegistrations"],[47,30,38,28],[47,33,38,31],[47,37,38,35],[47,38,38,36,"eventNames"],[47,48,38,46],[47,49,38,47,"map"],[47,52,38,50],[47,53,38,51,"eventName"],[47,62,38,60],[47,66,38,64],[47,70,38,64,"registerEventHandler"],[47,75,38,84],[47,76,38,84,"registerEventHandler"],[47,96,38,84],[47,98,38,85],[47,102,38,89],[47,103,38,90,"worklet"],[47,110,38,97],[47,112,38,99,"eventName"],[47,121,38,108],[47,123,38,110,"tag"],[47,126,38,113],[47,127,38,114],[47,128,38,115],[48,8,39,6],[48,12,39,10],[48,13,39,11],[48,14,39,12,"registrations"],[48,27,39,25],[48,28,39,26,"set"],[48,31,39,29],[48,32,39,30,"tag"],[48,35,39,33],[48,37,39,35,"newRegistrations"],[48,53,39,51],[48,54,39,52],[49,6,40,4],[49,7,40,5],[49,8,40,6],[50,4,41,2],[51,4,42,2,"registerForEvents"],[51,21,42,19,"registerForEvents"],[51,22,42,20,"viewTag"],[51,29,42,27],[51,31,42,29,"fallbackEventName"],[51,48,42,46],[51,50,42,48],[52,6,43,4],[52,10,43,8],[52,11,43,9],[52,12,43,10,"viewTags"],[52,20,43,18],[52,21,43,19,"add"],[52,24,43,22],[52,25,43,23,"viewTag"],[52,32,43,30],[52,33,43,31],[53,6,44,4],[53,12,44,10,"newRegistrations"],[53,28,44,26],[53,31,44,29],[53,35,44,33],[53,36,44,34,"eventNames"],[53,46,44,44],[53,47,44,45,"map"],[53,50,44,48],[53,51,44,49,"eventName"],[53,60,44,58],[53,64,44,62],[53,68,44,62,"registerEventHandler"],[53,73,44,82],[53,74,44,82,"registerEventHandler"],[53,94,44,82],[53,96,44,83],[53,100,44,87],[53,101,44,88,"worklet"],[53,108,44,95],[53,110,44,97,"eventName"],[53,119,44,106],[53,121,44,108,"viewTag"],[53,128,44,115],[53,129,44,116],[53,130,44,117],[54,6,45,4],[54,10,45,8],[54,11,45,9],[54,12,45,10,"registrations"],[54,25,45,23],[54,26,45,24,"set"],[54,29,45,27],[54,30,45,28,"viewTag"],[54,37,45,35],[54,39,45,37,"newRegistrations"],[54,55,45,53],[54,56,45,54],[55,6,46,4],[55,10,46,8],[55,14,46,12],[55,15,46,13,"eventNames"],[55,25,46,23],[55,26,46,24,"length"],[55,32,46,30],[55,37,46,35],[55,38,46,36],[55,42,46,40,"fallbackEventName"],[55,59,46,57],[55,61,46,59],[56,8,47,6],[56,14,47,12,"newRegistration"],[56,29,47,27],[56,32,47,30],[56,36,47,30,"registerEventHandler"],[56,41,47,50],[56,42,47,50,"registerEventHandler"],[56,62,47,50],[56,64,47,51],[56,68,47,55],[56,69,47,56,"worklet"],[56,76,47,63],[56,78,47,65,"fallbackEventName"],[56,95,47,82],[56,97,47,84,"viewTag"],[56,104,47,91],[56,105,47,92],[57,8,48,6],[57,12,48,10],[57,13,48,11],[57,14,48,12,"registrations"],[57,27,48,25],[57,28,48,26,"set"],[57,31,48,29],[57,32,48,30,"viewTag"],[57,39,48,37],[57,41,48,39],[57,42,48,40,"newRegistration"],[57,57,48,55],[57,58,48,56],[57,59,48,57],[58,6,49,4],[59,4,50,2],[60,4,51,2,"unregisterFromEvents"],[60,24,51,22,"unregisterFromEvents"],[60,25,51,23,"viewTag"],[60,32,51,30],[60,34,51,32],[61,6,52,4],[61,10,52,8],[61,11,52,9],[61,12,52,10,"viewTags"],[61,20,52,18],[61,21,52,19,"delete"],[61,27,52,25],[61,28,52,26,"viewTag"],[61,35,52,33],[61,36,52,34],[62,6,53,4],[62,10,53,8],[62,11,53,9],[62,12,53,10,"registrations"],[62,25,53,23],[62,26,53,24,"get"],[62,29,53,27],[62,30,53,28,"viewTag"],[62,37,53,35],[62,38,53,36],[62,40,53,38,"forEach"],[62,47,53,45],[62,48,53,46,"id"],[62,50,53,48],[62,54,53,52],[63,8,54,6],[63,12,54,6,"unregisterEventHandler"],[63,17,54,28],[63,18,54,28,"unregisterEventHandler"],[63,40,54,28],[63,42,54,29,"id"],[63,44,54,31],[63,45,54,32],[64,6,55,4],[64,7,55,5],[64,8,55,6],[65,6,56,4],[65,10,56,8],[65,11,56,9],[65,12,56,10,"registrations"],[65,25,56,23],[65,26,56,24,"delete"],[65,32,56,30],[65,33,56,31,"viewTag"],[65,40,56,38],[65,41,56,39],[66,4,57,2],[67,2,58,0],[68,2,59,0],[68,8,59,6,"WorkletEventHandlerWeb"],[68,30,59,28],[68,31,59,29],[69,4,60,2,"constructor"],[69,15,60,13,"constructor"],[69,16,60,14,"worklet"],[69,23,60,21],[69,25,60,23,"eventNames"],[69,35,60,33],[69,38,60,36],[69,40,60,38],[69,42,60,40],[70,6,61,4],[70,10,61,8],[70,11,61,9,"worklet"],[70,18,61,16],[70,21,61,19,"worklet"],[70,28,61,26],[71,6,62,4],[71,10,62,8],[71,11,62,9,"eventNames"],[71,21,62,19],[71,24,62,22,"eventNames"],[71,34,62,32],[72,6,63,4],[72,10,63,8],[72,11,63,9,"listeners"],[72,20,63,18],[72,23,63,21],[72,24,63,22],[72,25,63,23],[73,6,64,4],[73,10,64,8],[73,11,64,9,"setupWebListeners"],[73,28,64,26],[73,29,64,27],[73,30,64,28],[74,4,65,2],[75,4,66,2,"setupWebListeners"],[75,21,66,19,"setupWebListeners"],[75,22,66,19],[75,24,66,22],[76,6,67,4],[76,10,67,8],[76,11,67,9,"listeners"],[76,20,67,18],[76,23,67,21],[76,24,67,22],[76,25,67,23],[77,6,68,4],[77,10,68,8],[77,11,68,9,"eventNames"],[77,21,68,19],[77,22,68,20,"forEach"],[77,29,68,27],[77,30,68,28,"eventName"],[77,39,68,37],[77,43,68,41],[78,8,69,6],[78,12,69,10],[78,13,69,11,"listeners"],[78,22,69,20],[78,23,69,21,"eventName"],[78,32,69,30],[78,33,69,31],[78,36,69,34,"jsListener"],[78,46,69,44],[78,47,69,45,"eventName"],[78,56,69,54],[78,58,69,56],[78,62,69,60],[78,63,69,61,"worklet"],[78,70,69,68],[78,71,69,69],[79,6,70,4],[79,7,70,5],[79,8,70,6],[80,4,71,2],[81,4,72,2,"updateEventHandler"],[81,22,72,20,"updateEventHandler"],[81,23,72,21,"newWorklet"],[81,33,72,31],[81,35,72,33,"newEvents"],[81,44,72,42],[81,46,72,44],[82,6,73,4],[83,6,74,4],[83,10,74,8],[83,11,74,9,"worklet"],[83,18,74,16],[83,21,74,19,"newWorklet"],[83,31,74,29],[84,6,75,4],[84,10,75,8],[84,11,75,9,"eventNames"],[84,21,75,19],[84,24,75,22,"newEvents"],[84,33,75,31],[85,6,76,4],[85,10,76,8],[85,11,76,9,"setupWebListeners"],[85,28,76,26],[85,29,76,27],[85,30,76,28],[86,4,77,2],[87,4,78,2,"registerForEvents"],[87,21,78,19,"registerForEvents"],[87,22,78,20,"_viewTag"],[87,30,78,28],[87,32,78,30,"_fallbackEventName"],[87,50,78,48],[87,52,78,50],[88,6,79,4],[89,4,79,4],[90,4,81,2,"unregisterFromEvents"],[90,24,81,22,"unregisterFromEvents"],[90,25,81,23,"_viewTag"],[90,33,81,31],[90,35,81,33],[91,6,82,4],[92,4,82,4],[93,2,84,0],[94,2,85,7],[94,8,85,13,"WorkletEventHandler"],[94,27,85,32],[94,30,85,35,"SHOULD_BE_USE_WEB"],[94,37,85,52],[94,38,85,52,"SHOULD_BE_USE_WEB"],[94,55,85,52],[94,58,85,55,"WorkletEventHandlerWeb"],[94,80,85,77],[94,83,85,80,"WorkletEventHandlerNative"],[94,108,85,105],[95,0,85,106],[95,3]],"functionMap":{"names":["<global>","jsListener","<anonymous>","WorkletEventHandlerNative","WorkletEventHandlerNative#constructor","WorkletEventHandlerNative#updateEventHandler","forEach$argument_0","registrationIDs.forEach$argument_0","Array.from.forEach$argument_0","eventNames.map$argument_0","WorkletEventHandlerNative#registerForEvents","WorkletEventHandlerNative#unregisterFromEvents","get.forEach$argument_0","WorkletEventHandlerWeb","WorkletEventHandlerWeb#constructor","WorkletEventHandlerWeb#setupWebListeners","eventNames.forEach$argument_0","WorkletEventHandlerWeb#updateEventHandler","WorkletEventHandlerWeb#registerForEvents","WorkletEventHandlerWeb#unregisterFromEvents"],"mappings":"AAA;ACO;SCC;GDK;CDC;AGC;ECG;GDK;EEC;gCCM;8BCC,gCD;KDE;uCGG;mDCC,+DD;KHE;GFC;EOC;iDDE,mEC;GPM;EQC;8CCE;KDE;GRE;CHC;AaC;ECC;GDK;EEC;4BCE;KDE;GFC;EIC;GJK;EKC;GLE;EMC;GNE;CbC"},"hasCjsExports":false},"type":"js/module"}]}