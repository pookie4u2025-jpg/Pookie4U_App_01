{"dependencies":[{"name":"./common","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":15},"end":{"line":3,"column":45,"index":60}}],"key":"T3X1rGrsueEhPeOGTLhHRm6Tz+4=","exportNames":["*"],"imports":1}},{"name":"./core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":61},"end":{"line":4,"column":70,"index":131}}],"key":"0ONCEUiDM4TuRiJMnypk4k7v4nE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  'use strict';\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"WorkletEventHandler\", {\n    enumerable: true,\n    get: function () {\n      return WorkletEventHandler;\n    }\n  });\n  var _common = require(_dependencyMap[0], \"./common\");\n  var _core = require(_dependencyMap[1], \"./core\");\n  // In JS implementation (e.g. for web) we don't use Reanimated's\n  // event emitter, therefore we have to handle here\n  // the event that came from React Native and convert it.\n  function jsListener(eventName, handler) {\n    return evt => {\n      handler({\n        ...evt.nativeEvent,\n        eventName\n      });\n    };\n  }\n  class WorkletEventHandlerNative {\n    #viewTags;\n    #registrations; // keys are viewTags, values are arrays of registration ID's for each viewTag\n    constructor(worklet, eventNames) {\n      this.worklet = worklet;\n      this.eventNames = eventNames;\n      this.#viewTags = new Set();\n      this.#registrations = new Map();\n    }\n    updateEventHandler(newWorklet, newEvents) {\n      // Update worklet and event names\n      this.worklet = newWorklet;\n      this.eventNames = newEvents;\n\n      // Detach all events\n      this.#registrations.forEach(registrationIDs => {\n        registrationIDs.forEach(id => (0, _core.unregisterEventHandler)(id));\n        // No need to remove registrationIDs from map, since it gets overwritten when attaching\n      });\n\n      // Attach new events with new worklet\n      Array.from(this.#viewTags).forEach(tag => {\n        const newRegistrations = this.eventNames.map(eventName => (0, _core.registerEventHandler)(this.worklet, eventName, tag));\n        this.#registrations.set(tag, newRegistrations);\n      });\n    }\n    registerForEvents(viewTag, fallbackEventName) {\n      this.#viewTags.add(viewTag);\n      const newRegistrations = this.eventNames.map(eventName => (0, _core.registerEventHandler)(this.worklet, eventName, viewTag));\n      this.#registrations.set(viewTag, newRegistrations);\n      if (this.eventNames.length === 0 && fallbackEventName) {\n        const newRegistration = (0, _core.registerEventHandler)(this.worklet, fallbackEventName, viewTag);\n        this.#registrations.set(viewTag, [newRegistration]);\n      }\n    }\n    unregisterFromEvents(viewTag) {\n      this.#viewTags.delete(viewTag);\n      this.#registrations.get(viewTag)?.forEach(id => {\n        (0, _core.unregisterEventHandler)(id);\n      });\n      this.#registrations.delete(viewTag);\n    }\n  }\n  class WorkletEventHandlerWeb {\n    constructor(worklet, eventNames = []) {\n      this.worklet = worklet;\n      this.eventNames = eventNames;\n      this.listeners = {};\n      this.setupWebListeners();\n    }\n    setupWebListeners() {\n      this.listeners = {};\n      this.eventNames.forEach(eventName => {\n        this.listeners[eventName] = jsListener(eventName, this.worklet);\n      });\n    }\n    updateEventHandler(newWorklet, newEvents) {\n      // Update worklet and event names\n      this.worklet = newWorklet;\n      this.eventNames = newEvents;\n      this.setupWebListeners();\n    }\n    registerForEvents(_viewTag, _fallbackEventName) {\n      // noop\n    }\n    unregisterFromEvents(_viewTag) {\n      // noop\n    }\n  }\n  const WorkletEventHandler = _common.SHOULD_BE_USE_WEB ? WorkletEventHandlerWeb : WorkletEventHandlerNative;\n});","lineCount":96,"map":[[2,2,1,0],[2,14,1,12],[4,2,1,13,"Object"],[4,8,1,13],[4,9,1,13,"defineProperty"],[4,23,1,13],[4,24,1,13,"exports"],[4,31,1,13],[5,4,1,13,"value"],[5,9,1,13],[6,2,1,13],[7,2,85,0,"Object"],[7,8,85,0],[7,9,85,0,"defineProperty"],[7,23,85,0],[7,24,85,0,"exports"],[7,31,85,0],[8,4,85,0,"enumerable"],[8,14,85,0],[9,4,85,0,"get"],[9,7,85,0],[9,18,85,0,"get"],[9,19,85,0],[10,6,85,0],[10,13,85,0,"WorkletEventHandler"],[10,32,85,0],[11,4,85,0],[12,2,85,0],[13,2,3,0],[13,6,3,0,"_common"],[13,13,3,0],[13,16,3,0,"require"],[13,23,3,0],[13,24,3,0,"_dependencyMap"],[13,38,3,0],[14,2,4,0],[14,6,4,0,"_core"],[14,11,4,0],[14,14,4,0,"require"],[14,21,4,0],[14,22,4,0,"_dependencyMap"],[14,36,4,0],[15,2,5,0],[16,2,6,0],[17,2,7,0],[18,2,8,0],[18,11,8,9,"jsListener"],[18,21,8,19,"jsListener"],[18,22,8,20,"eventName"],[18,31,8,29],[18,33,8,31,"handler"],[18,40,8,38],[18,42,8,40],[19,4,9,2],[19,11,9,9,"evt"],[19,14,9,12],[19,18,9,16],[20,6,10,4,"handler"],[20,13,10,11],[20,14,10,12],[21,8,11,6],[21,11,11,9,"evt"],[21,14,11,12],[21,15,11,13,"nativeEvent"],[21,26,11,24],[22,8,12,6,"eventName"],[23,6,13,4],[23,7,13,5],[23,8,13,6],[24,4,14,2],[24,5,14,3],[25,2,15,0],[26,2,16,0],[26,8,16,6,"WorkletEventHandlerNative"],[26,33,16,31],[26,34,16,32],[27,4,17,2],[27,5,17,3,"viewTags"],[27,13,17,11],[28,4,18,2],[28,5,18,3,"registrations"],[28,18,18,16],[28,19,18,17],[28,20,18,18],[29,4,19,2,"constructor"],[29,15,19,13,"constructor"],[29,16,19,14,"worklet"],[29,23,19,21],[29,25,19,23,"eventNames"],[29,35,19,33],[29,37,19,35],[30,6,20,4],[30,10,20,8],[30,11,20,9,"worklet"],[30,18,20,16],[30,21,20,19,"worklet"],[30,28,20,26],[31,6,21,4],[31,10,21,8],[31,11,21,9,"eventNames"],[31,21,21,19],[31,24,21,22,"eventNames"],[31,34,21,32],[32,6,22,4],[32,10,22,8],[32,11,22,9],[32,12,22,10,"viewTags"],[32,20,22,18],[32,23,22,21],[32,27,22,25,"Set"],[32,30,22,28],[32,31,22,29],[32,32,22,30],[33,6,23,4],[33,10,23,8],[33,11,23,9],[33,12,23,10,"registrations"],[33,25,23,23],[33,28,23,26],[33,32,23,30,"Map"],[33,35,23,33],[33,36,23,34],[33,37,23,35],[34,4,24,2],[35,4,25,2,"updateEventHandler"],[35,22,25,20,"updateEventHandler"],[35,23,25,21,"newWorklet"],[35,33,25,31],[35,35,25,33,"newEvents"],[35,44,25,42],[35,46,25,44],[36,6,26,4],[37,6,27,4],[37,10,27,8],[37,11,27,9,"worklet"],[37,18,27,16],[37,21,27,19,"newWorklet"],[37,31,27,29],[38,6,28,4],[38,10,28,8],[38,11,28,9,"eventNames"],[38,21,28,19],[38,24,28,22,"newEvents"],[38,33,28,31],[40,6,30,4],[41,6,31,4],[41,10,31,8],[41,11,31,9],[41,12,31,10,"registrations"],[41,25,31,23],[41,26,31,24,"forEach"],[41,33,31,31],[41,34,31,32,"registrationIDs"],[41,49,31,47],[41,53,31,51],[42,8,32,6,"registrationIDs"],[42,23,32,21],[42,24,32,22,"forEach"],[42,31,32,29],[42,32,32,30,"id"],[42,34,32,32],[42,38,32,36],[42,42,32,36,"unregisterEventHandler"],[42,47,32,58],[42,48,32,58,"unregisterEventHandler"],[42,70,32,58],[42,72,32,59,"id"],[42,74,32,61],[42,75,32,62],[42,76,32,63],[43,8,33,6],[44,6,34,4],[44,7,34,5],[44,8,34,6],[46,6,36,4],[47,6,37,4,"Array"],[47,11,37,9],[47,12,37,10,"from"],[47,16,37,14],[47,17,37,15],[47,21,37,19],[47,22,37,20],[47,23,37,21,"viewTags"],[47,31,37,29],[47,32,37,30],[47,33,37,31,"forEach"],[47,40,37,38],[47,41,37,39,"tag"],[47,44,37,42],[47,48,37,46],[48,8,38,6],[48,14,38,12,"newRegistrations"],[48,30,38,28],[48,33,38,31],[48,37,38,35],[48,38,38,36,"eventNames"],[48,48,38,46],[48,49,38,47,"map"],[48,52,38,50],[48,53,38,51,"eventName"],[48,62,38,60],[48,66,38,64],[48,70,38,64,"registerEventHandler"],[48,75,38,84],[48,76,38,84,"registerEventHandler"],[48,96,38,84],[48,98,38,85],[48,102,38,89],[48,103,38,90,"worklet"],[48,110,38,97],[48,112,38,99,"eventName"],[48,121,38,108],[48,123,38,110,"tag"],[48,126,38,113],[48,127,38,114],[48,128,38,115],[49,8,39,6],[49,12,39,10],[49,13,39,11],[49,14,39,12,"registrations"],[49,27,39,25],[49,28,39,26,"set"],[49,31,39,29],[49,32,39,30,"tag"],[49,35,39,33],[49,37,39,35,"newRegistrations"],[49,53,39,51],[49,54,39,52],[50,6,40,4],[50,7,40,5],[50,8,40,6],[51,4,41,2],[52,4,42,2,"registerForEvents"],[52,21,42,19,"registerForEvents"],[52,22,42,20,"viewTag"],[52,29,42,27],[52,31,42,29,"fallbackEventName"],[52,48,42,46],[52,50,42,48],[53,6,43,4],[53,10,43,8],[53,11,43,9],[53,12,43,10,"viewTags"],[53,20,43,18],[53,21,43,19,"add"],[53,24,43,22],[53,25,43,23,"viewTag"],[53,32,43,30],[53,33,43,31],[54,6,44,4],[54,12,44,10,"newRegistrations"],[54,28,44,26],[54,31,44,29],[54,35,44,33],[54,36,44,34,"eventNames"],[54,46,44,44],[54,47,44,45,"map"],[54,50,44,48],[54,51,44,49,"eventName"],[54,60,44,58],[54,64,44,62],[54,68,44,62,"registerEventHandler"],[54,73,44,82],[54,74,44,82,"registerEventHandler"],[54,94,44,82],[54,96,44,83],[54,100,44,87],[54,101,44,88,"worklet"],[54,108,44,95],[54,110,44,97,"eventName"],[54,119,44,106],[54,121,44,108,"viewTag"],[54,128,44,115],[54,129,44,116],[54,130,44,117],[55,6,45,4],[55,10,45,8],[55,11,45,9],[55,12,45,10,"registrations"],[55,25,45,23],[55,26,45,24,"set"],[55,29,45,27],[55,30,45,28,"viewTag"],[55,37,45,35],[55,39,45,37,"newRegistrations"],[55,55,45,53],[55,56,45,54],[56,6,46,4],[56,10,46,8],[56,14,46,12],[56,15,46,13,"eventNames"],[56,25,46,23],[56,26,46,24,"length"],[56,32,46,30],[56,37,46,35],[56,38,46,36],[56,42,46,40,"fallbackEventName"],[56,59,46,57],[56,61,46,59],[57,8,47,6],[57,14,47,12,"newRegistration"],[57,29,47,27],[57,32,47,30],[57,36,47,30,"registerEventHandler"],[57,41,47,50],[57,42,47,50,"registerEventHandler"],[57,62,47,50],[57,64,47,51],[57,68,47,55],[57,69,47,56,"worklet"],[57,76,47,63],[57,78,47,65,"fallbackEventName"],[57,95,47,82],[57,97,47,84,"viewTag"],[57,104,47,91],[57,105,47,92],[58,8,48,6],[58,12,48,10],[58,13,48,11],[58,14,48,12,"registrations"],[58,27,48,25],[58,28,48,26,"set"],[58,31,48,29],[58,32,48,30,"viewTag"],[58,39,48,37],[58,41,48,39],[58,42,48,40,"newRegistration"],[58,57,48,55],[58,58,48,56],[58,59,48,57],[59,6,49,4],[60,4,50,2],[61,4,51,2,"unregisterFromEvents"],[61,24,51,22,"unregisterFromEvents"],[61,25,51,23,"viewTag"],[61,32,51,30],[61,34,51,32],[62,6,52,4],[62,10,52,8],[62,11,52,9],[62,12,52,10,"viewTags"],[62,20,52,18],[62,21,52,19,"delete"],[62,27,52,25],[62,28,52,26,"viewTag"],[62,35,52,33],[62,36,52,34],[63,6,53,4],[63,10,53,8],[63,11,53,9],[63,12,53,10,"registrations"],[63,25,53,23],[63,26,53,24,"get"],[63,29,53,27],[63,30,53,28,"viewTag"],[63,37,53,35],[63,38,53,36],[63,40,53,38,"forEach"],[63,47,53,45],[63,48,53,46,"id"],[63,50,53,48],[63,54,53,52],[64,8,54,6],[64,12,54,6,"unregisterEventHandler"],[64,17,54,28],[64,18,54,28,"unregisterEventHandler"],[64,40,54,28],[64,42,54,29,"id"],[64,44,54,31],[64,45,54,32],[65,6,55,4],[65,7,55,5],[65,8,55,6],[66,6,56,4],[66,10,56,8],[66,11,56,9],[66,12,56,10,"registrations"],[66,25,56,23],[66,26,56,24,"delete"],[66,32,56,30],[66,33,56,31,"viewTag"],[66,40,56,38],[66,41,56,39],[67,4,57,2],[68,2,58,0],[69,2,59,0],[69,8,59,6,"WorkletEventHandlerWeb"],[69,30,59,28],[69,31,59,29],[70,4,60,2,"constructor"],[70,15,60,13,"constructor"],[70,16,60,14,"worklet"],[70,23,60,21],[70,25,60,23,"eventNames"],[70,35,60,33],[70,38,60,36],[70,40,60,38],[70,42,60,40],[71,6,61,4],[71,10,61,8],[71,11,61,9,"worklet"],[71,18,61,16],[71,21,61,19,"worklet"],[71,28,61,26],[72,6,62,4],[72,10,62,8],[72,11,62,9,"eventNames"],[72,21,62,19],[72,24,62,22,"eventNames"],[72,34,62,32],[73,6,63,4],[73,10,63,8],[73,11,63,9,"listeners"],[73,20,63,18],[73,23,63,21],[73,24,63,22],[73,25,63,23],[74,6,64,4],[74,10,64,8],[74,11,64,9,"setupWebListeners"],[74,28,64,26],[74,29,64,27],[74,30,64,28],[75,4,65,2],[76,4,66,2,"setupWebListeners"],[76,21,66,19,"setupWebListeners"],[76,22,66,19],[76,24,66,22],[77,6,67,4],[77,10,67,8],[77,11,67,9,"listeners"],[77,20,67,18],[77,23,67,21],[77,24,67,22],[77,25,67,23],[78,6,68,4],[78,10,68,8],[78,11,68,9,"eventNames"],[78,21,68,19],[78,22,68,20,"forEach"],[78,29,68,27],[78,30,68,28,"eventName"],[78,39,68,37],[78,43,68,41],[79,8,69,6],[79,12,69,10],[79,13,69,11,"listeners"],[79,22,69,20],[79,23,69,21,"eventName"],[79,32,69,30],[79,33,69,31],[79,36,69,34,"jsListener"],[79,46,69,44],[79,47,69,45,"eventName"],[79,56,69,54],[79,58,69,56],[79,62,69,60],[79,63,69,61,"worklet"],[79,70,69,68],[79,71,69,69],[80,6,70,4],[80,7,70,5],[80,8,70,6],[81,4,71,2],[82,4,72,2,"updateEventHandler"],[82,22,72,20,"updateEventHandler"],[82,23,72,21,"newWorklet"],[82,33,72,31],[82,35,72,33,"newEvents"],[82,44,72,42],[82,46,72,44],[83,6,73,4],[84,6,74,4],[84,10,74,8],[84,11,74,9,"worklet"],[84,18,74,16],[84,21,74,19,"newWorklet"],[84,31,74,29],[85,6,75,4],[85,10,75,8],[85,11,75,9,"eventNames"],[85,21,75,19],[85,24,75,22,"newEvents"],[85,33,75,31],[86,6,76,4],[86,10,76,8],[86,11,76,9,"setupWebListeners"],[86,28,76,26],[86,29,76,27],[86,30,76,28],[87,4,77,2],[88,4,78,2,"registerForEvents"],[88,21,78,19,"registerForEvents"],[88,22,78,20,"_viewTag"],[88,30,78,28],[88,32,78,30,"_fallbackEventName"],[88,50,78,48],[88,52,78,50],[89,6,79,4],[90,4,79,4],[91,4,81,2,"unregisterFromEvents"],[91,24,81,22,"unregisterFromEvents"],[91,25,81,23,"_viewTag"],[91,33,81,31],[91,35,81,33],[92,6,82,4],[93,4,82,4],[94,2,84,0],[95,2,85,7],[95,8,85,13,"WorkletEventHandler"],[95,27,85,32],[95,30,85,35,"SHOULD_BE_USE_WEB"],[95,37,85,52],[95,38,85,52,"SHOULD_BE_USE_WEB"],[95,55,85,52],[95,58,85,55,"WorkletEventHandlerWeb"],[95,80,85,77],[95,83,85,80,"WorkletEventHandlerNative"],[95,108,85,105],[96,0,85,106],[96,3]],"functionMap":{"names":["<global>","jsListener","<anonymous>","WorkletEventHandlerNative","WorkletEventHandlerNative#constructor","WorkletEventHandlerNative#updateEventHandler","forEach$argument_0","registrationIDs.forEach$argument_0","Array.from.forEach$argument_0","eventNames.map$argument_0","WorkletEventHandlerNative#registerForEvents","WorkletEventHandlerNative#unregisterFromEvents","get.forEach$argument_0","WorkletEventHandlerWeb","WorkletEventHandlerWeb#constructor","WorkletEventHandlerWeb#setupWebListeners","eventNames.forEach$argument_0","WorkletEventHandlerWeb#updateEventHandler","WorkletEventHandlerWeb#registerForEvents","WorkletEventHandlerWeb#unregisterFromEvents"],"mappings":"AAA;ACO;SCC;GDK;CDC;AGC;ECG;GDK;EEC;gCCM;8BCC,gCD;KDE;uCGG;mDCC,+DD;KHE;GFC;EOC;iDDE,mEC;GPM;EQC;8CCE;KDE;GRE;CHC;AaC;ECC;GDK;EEC;4BCE;KDE;GFC;EIC;GJK;EKC;GLE;EMC;GNE;CbC"},"hasCjsExports":false},"type":"js/module"}]}